
const translations = {
    en: {
        dir: 'ltr',
        lang: 'en',
        css: 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css',
        content: {
            'main-heading': "Sustainability Through the Ages",
            'main-subtitle': "Explore Intel's journey through time, discovering how our commitment to innovation has shaped a more sustainable future for technology and our planet.",
            'strategies-heading': "Our Strategies",
            'strategy-1-title': "RISE Strategy",
            'strategy-2-title': "Supply Chain",
            'strategy-3-title': "Digital Equity",
            'modalLabel1': "RISE Strategy Details",
            'modalLabel2': "Supply Chain Details",
            'modalLabel3': "Digital Equity Details",
            'footer-heading': "Subscribe to our Newsletter",
            'label-email': "Email address",
            'btn-subscribe': "Subscribe"
        },
        timeline: [
            { year: "1968", title: "Founding", desc: "Intel was founded by Robert Noyce and Gordon Moore, and Andrew Grove. They renamed the company NM Electronics to Intel Corporation." },
            { year: "1971", title: "First Microprocessor", desc: "The 4004 was the world's first commercially available microprocessor, marking the start of the digital revolution." },
            { year: "1978", title: "8086 Processor", desc: "The 8086 processor introduced the x86 architecture, which continues to dominate desktop computing today." },
            { year: "1985", title: "386 Processor", desc: "The Intel 386 processor featured 32-bit architecture and a multitasking capability, redefining PC performance." },
            { year: "2006", title: "Peak GHG Emissions", desc: "This year marks Intel's highest annual greenhouse gas emissions for operations. Over subsequent years, Intel invests heavily in chemical abatement, renewable energy, and energy-efficient manufacturing to reverse this trend." },
            { year: "2020", title: "RISE Strategy", desc: "Intel launches its RISE (Responsible, Inclusive, Sustainable, Enabling) strategy and 2030 goals, aiming to drive industry-wide progress on climate action, water stewardship, and waste reduction." },
            { year: "2022", title: "Net-Zero By 2040", desc: "Intel announces its commitment to achieve net-zero greenhouse gas emissions (Scope 1 and 2) across its global operations by 2040, building on years of environmental initiatives." },
            { year: "2023", title: "Renewable Electricity", desc: "The company achieves 99% renewable electricity usage worldwide, helping to drastically lower carbon emissions and driving progress toward Intel's long-term sustainability goals." },
            { year: "2024", title: "Sustainability Summit", desc: "Intel hosts its first Sustainability Summit, uniting suppliers, government officials, and industry leaders to collaborate on next-generation sustainable semiconductor manufacturing." }
        ]
    },
    ar: {
        dir: 'rtl',
        lang: 'ar',
        css: 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css',
        content: {
            'main-heading': "الاستدامة عبر العصور",
            'main-subtitle': "اكتشف رحلة إنتل عبر الزمن، وتعرف على كيف ساهم التزامنا بالابتكار في تشكيل مستقبل أكثر استدامة للتكنولوجيا وكوكبنا.",
            'strategies-heading': "استراتيجياتنا",
            'strategy-1-title': "استراتيجية RISE",
            'strategy-2-title': "سلسلة التوريد",
            'strategy-3-title': "العدالة الرقمية",
            'modalLabel1': "تفاصيل استراتيجية RISE",
            'modalLabel2': "تفاصيل سلسلة التوريد",
            'modalLabel3': "تفاصيل العدالة الرقمية",
            'footer-heading': "اشترك في نشرتنا الإخبارية",
            'label-email': "عنوان البريد الإلكتروني",
            'btn-subscribe': "اشترك"
        },
        timeline: [
            { year: "١٩٦٨", title: "تأسيس", desc: "تأسست إنتل بواسطة روبرت نويس وجوردون مور وأندرو غروف. قاموا بتغيير اسم الشركة من NM Electronics إلى شركة إنتل." },
            { year: "١٩٧١", title: "أول معالج دقيق", desc: "كان المعالج 4004 أول معالج دقيق متاح تجاريًا في العالم، مما يمثل بداية الثورة الرقمية." },
            { year: "١٩٧٨", title: "معالج 8086", desc: "قدم معالج 8086 هندسة x86، التي لا تزال تهيمن على حوسبة سطح المكتب اليوم." },
            { year: "١٩٨٥", title: "معالج 386", desc: "تميز معالج إنتل 386 بمعمارية 32 بت وقدرة تعدد المهام، مما أعاد تعريف أداء الحاسوب الشخصي." },
            { year: "٢٠٠٦", title: "ذروة انبعاثات الغازات الدفيئة", desc: "يمثل هذا العام أعلى انبعاثات سنوية لغازات الاحتباس الحراري لعمليات إنتل. استثمرت إنتل لاحقًا بكثافة في المعالجة الكيميائية والطاقة المتجددة لعكس هذا الاتجاه." },
            { year: "٢٠٢٠", title: "استراتيجية RISE", desc: "أطلقت إنتل استراتيجية RISE وأهداف 2030، بهدف دفع التقدم الصناعي في العمل المناخي للإشراف على المياه والحد من النفايات." },
            { year: "٢٠٢٢", title: "صافي انبعاثات صفري بحلول 2040", desc: "أعلنت إنتل التزامها بتحقيق صافي انبعاثات صفري عبر عملياتها العالمية بحلول عام 2040، بناءً على سنوات من المبادرات البيئية." },
            { year: "٢٠٢٣", title: "الكهرباء المتجددة", desc: "حققت الشركة استخدامًا للكهرباء المتجددة بنسبة 99% عالميًا، مما ساعد في خفض الكربون بشكل كبير ودفع التقدم نحو أهداف الاستدامة." },
            { year: "٢٠٢٤", title: "قمة الاستدامة", desc: "استضافت إنتل أول قمة للاستدامة، لتوحيد الموردين والمسؤولين وقادة الصناعة للتعاون في تصنيع أشباه الموصلات المستدام." }
        ]
    }
};

function setLanguage(langCode) {
    const cleanLang = langCode.startsWith('ar') ? 'ar' : 'en';
    const config = translations[cleanLang];
    const htmlEl = document.documentElement;

    // 1. Update HTML attributes
    htmlEl.setAttribute('lang', config.lang);
    htmlEl.setAttribute('dir', config.dir);

    // 2. Swap Bootstrap CSS
    const bootstrapLink = document.getElementById('bootstrap-css');
    if (bootstrapLink) {
        bootstrapLink.setAttribute('href', config.css);
    }

    // 3. Update Text Content by ID
    for (const [id, text] of Object.entries(config.content)) {
        const element = document.getElementById(id);
        if (element) {
            element.textContent = text;
        }
    }

    // 4. Update Timeline Cards
    const cards = document.querySelectorAll('.timeline-container .card');
    cards.forEach((card, index) => {
        if (config.timeline[index]) {
            const data = config.timeline[index];
            const h2 = card.querySelector('h2');
            const h3 = card.querySelector('h3');
            const p = card.querySelector('.card-details p');
            
            if(h2) h2.textContent = data.year;
            if(h3) h3.textContent = data.title;
            if(p) p.textContent = data.desc;
        }
    });

    // 5. Update Placeholders for Inputs
    const emailInput = document.getElementById('emailInput');
    if (emailInput) {
        emailInput.placeholder = cleanLang === 'ar' ? "البريد الإلكتروني" : "name@example.com";
    }

    // 6. Update Learn More Buttons
    const learnMoreBtns = document.querySelectorAll('.learn-more-btn');
    learnMoreBtns.forEach(btn => {
        btn.textContent = cleanLang === 'ar' ? "اعرف المزيد" : "Learn More";
    });

    // 7. Update Modal Close Buttons
    const closeBtns = document.querySelectorAll('.btn-close-modal');
    closeBtns.forEach(btn => {
        btn.textContent = cleanLang === 'ar' ? "إغلاق" : "Close";
    });

    // console.log(`Language set to ${cleanLang}`);
}

// Check browser language on load
document.addEventListener('DOMContentLoaded', () => {
    const browserLang = navigator.language || navigator.userLanguage || 'en';
    setLanguage(browserLang);

    // Initialize MutationObserver to detect external changes (e.g., Google Translate)
    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.type === 'attributes') {
                const htmlEl = document.documentElement;
                const currentLang = htmlEl.getAttribute('lang');
                const classList = htmlEl.classList;

                // Check if language became Arabic or if translation tool detected Arabic
                // Google Translate for Arabic often adds "translated-rtl" class or sets lang="ar"
                const isArabic = currentLang.startsWith('ar') || classList.contains('translated-rtl');

                // If Arabic is detected but we are not in RTL mode, enforce it
                if (isArabic && htmlEl.getAttribute('dir') !== 'rtl') {
                    setLanguage('ar');
                }
                
                // If it reverts to English (and not just some other class change while staying Arabic)
                else if (currentLang.startsWith('en') && htmlEl.getAttribute('dir') === 'rtl' && !classList.contains('translated-rtl')) {
                    setLanguage('en');
                }
            }
        });
    });

    // Start observing the html element
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['lang', 'class']
    });
});

// Detect dynamic language changes
window.addEventListener('languagechange', () => {
    const browserLang = navigator.language || navigator.userLanguage || 'en';
    setLanguage(browserLang);
});

